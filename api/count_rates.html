

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Coronagraph Noise Modeling &mdash; coronagraph 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="coronagraph 0.1 documentation" href="../index.html"/>
        <link rel="up" title="API" href="../api.html"/>
        <link rel="next" title="Observational Routines" href="observe.html"/>
        <link rel="prev" title="API" href="../api.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo1.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Scripts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Coronagraph Noise Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="observe.html">Observational Routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="teleplanstar.html">Telescopes, Planets, and Stars</a></li>
<li class="toctree-l2"><a class="reference internal" href="noise_routines.html">Noise Routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="degrade_spec.html">Degrade Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="imager.html">Filter Photometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="transits.html">Simulating Transmission and Emission Spectroscopy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/jlustigy/coronagraph">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/jlustigy/coronagraph/issues">Submit an issue</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">coronagraph</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">API</a> &raquo;</li>
        
      <li>Coronagraph Noise Modeling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/count_rates.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="module-coronagraph.count_rates">
<span id="coronagraph-noise-modeling"></span><h1>Coronagraph Noise Modeling<a class="headerlink" href="#module-coronagraph.count_rates" title="Permalink to this headline">¶</a></h1>
<p>The crux of <code class="docutils literal notranslate"><span class="pre">coronagraph</span></code> noise modeling is to determine the photon count rate
incident upon the detector due to both the target planet and an assortment of
different telescope, instrumental, and astrophysical noise sources.
The following classes and functions serve as your interface to the photon count
rate calculations. The core function for these calculations is
<a class="reference internal" href="#coronagraph.count_rates.count_rates" title="coronagraph.count_rates.count_rates"><code class="xref py py-func docutils literal notranslate"><span class="pre">count_rates()</span></code></a>, but it may be accessed using the <a class="reference internal" href="#coronagraph.count_rates.CoronagraphNoise" title="coronagraph.count_rates.CoronagraphNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoronagraphNoise</span></code></a>
object.</p>
<dl class="class">
<dt id="coronagraph.count_rates.CoronagraphNoise">
<em class="property">class </em><code class="descclassname">coronagraph.count_rates.</code><code class="descname">CoronagraphNoise</code><span class="sig-paren">(</span><em>telescope=&lt;coronagraph.teleplanstar.Telescope object&gt;</em>, <em>planet=&lt;coronagraph.teleplanstar.Planet object&gt;</em>, <em>star=&lt;coronagraph.teleplanstar.Star object&gt;</em>, <em>texp=10.0</em>, <em>wantsnr=10.0</em>, <em>FIX_OWA=False</em>, <em>COMPUTE_LAM=False</em>, <em>SILENT=False</em>, <em>NIR=False</em>, <em>THERMAL=True</em>, <em>GROUND=False</em>, <em>vod=False</em>, <em>set_fpa=None</em>, <em>roll_maneuver=True</em><span class="sig-paren">)</span><a class="headerlink" href="#coronagraph.count_rates.CoronagraphNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>The primary interface for <code class="docutils literal notranslate"><span class="pre">coronagraph</span></code> noise modeling. This object wraps
around the functionality of <a class="reference internal" href="#coronagraph.count_rates.count_rates" title="coronagraph.count_rates.count_rates"><code class="xref py py-func docutils literal notranslate"><span class="pre">count_rates()</span></code></a>. Simply instantiate a
<cite>CoronagraphNoise</cite> object by passing it <code class="xref py py-class docutils literal notranslate"><span class="pre">telescope</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">planet</span></code>,
and <code class="xref py py-class docutils literal notranslate"><span class="pre">star</span></code> objects, and then call
<a class="reference internal" href="#coronagraph.count_rates.CoronagraphNoise.run_count_rates" title="coronagraph.count_rates.CoronagraphNoise.run_count_rates"><code class="xref py py-func docutils literal notranslate"><span class="pre">CoronagraphNoise.run_count_rates()</span></code></a> to perform the photon count rate
calculation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>telescope</strong> (<a class="reference internal" href="teleplanstar.html#coronagraph.teleplanstar.Telescope" title="coronagraph.teleplanstar.Telescope"><em>Telescope</em></a>) – Initialized object containing <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> parameters</li>
<li><strong>planet</strong> (<a class="reference internal" href="teleplanstar.html#coronagraph.teleplanstar.Planet" title="coronagraph.teleplanstar.Planet"><em>Planet</em></a>) – Initialized object containing <code class="docutils literal notranslate"><span class="pre">Planet</span></code> parameters</li>
<li><strong>star</strong> (<a class="reference internal" href="teleplanstar.html#coronagraph.teleplanstar.Star" title="coronagraph.teleplanstar.Star"><em>Star</em></a>) – Initialized object containing <code class="docutils literal notranslate"><span class="pre">Star</span></code> parameters</li>
<li><strong>texp</strong> (<em>float</em>) – Exposure time for which to generate synthetic data [hours]</li>
<li><strong>wantsnr</strong> (<em>float</em><em>, </em><em>optional</em>) – Desired signal-to-noise ratio in each pixel</li>
<li><strong>FIX_OWA</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to fix OWA at <code class="docutils literal notranslate"><span class="pre">OWA*lammin/D</span></code>, as would occur if lenslet array is
limiting the OWA</li>
<li><strong>COMPUTE_LAM</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to compute lo-res wavelength grid, otherwise the grid input as
variable <code class="docutils literal notranslate"><span class="pre">lam</span></code> is used</li>
<li><strong>SILENT</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to suppress print statements</li>
<li><strong>NIR</strong> (<em>bool</em><em>, </em><em>optional</em>) – Re-adjusts pixel size in NIR, as would occur if a second instrument
was designed to handle the NIR</li>
<li><strong>THERMAL</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to compute thermal photon counts due to telescope temperature</li>
<li><strong>GROUND</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to simulate ground-based observations through atmosphere</li>
<li><strong>vod</strong> (<em>bool</em><em>, </em><em>optional</em>) – “Valley of Death” red QE parameterization from Robinson et al. (2016)</li>
<li><strong>set_fpa</strong> (<em>float</em><em>, </em><em>optional</em>) – Specify the fraction of planetary signal in Airy pattern, default will
calculate it from the photometric aperture size <cite>X</cite></li>
<li><strong>roll_maneuver</strong> (<em>bool</em><em>, </em><em>optional</em>) – This assumes an extra factor of 2 hit to the background noise due to a
telescope roll maneuver needed to subtract out the background. See
Brown (2005) for more details.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The results of the coronagraph noise calculation will become available as
attributes of the <a class="reference internal" href="#coronagraph.count_rates.CoronagraphNoise" title="coronagraph.count_rates.CoronagraphNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoronagraphNoise</span></code></a> object after
<a class="reference internal" href="#coronagraph.count_rates.CoronagraphNoise.run_count_rates" title="coronagraph.count_rates.CoronagraphNoise.run_count_rates"><code class="xref py py-func docutils literal notranslate"><span class="pre">CoronagraphNoise.run_count_rates()</span></code></a> is called.</p>
</div>
<dl class="method">
<dt id="coronagraph.count_rates.CoronagraphNoise.run_count_rates">
<code class="descname">run_count_rates</code><span class="sig-paren">(</span><em>Ahr</em>, <em>lamhr</em>, <em>solhr</em><span class="sig-paren">)</span><a class="headerlink" href="#coronagraph.count_rates.CoronagraphNoise.run_count_rates" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the photon count rates and signal to noise on a
coronagraph observation given a wavelength-dependent planetary
geometric albedo and stellar flux density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Ahr</strong> (<em>array</em>) – High-res, wavelength-dependent planetary geometric albedo</li>
<li><strong>lamhr</strong> (<em>array</em>) – High-res wavelength grid  [um]</li>
<li><strong>solhr</strong> (<em>array</em>) – High-res TOA solar spectrum [W/m**2/um]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Calling <code class="docutils literal notranslate"><span class="pre">run_count_rates()</span></code> creates the following attributes for
the <code class="docutils literal notranslate"><span class="pre">CoronagraphNoise</span></code> instance:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>Ahr</strong> (<em>array</em>) – High-res, wavelength-dependent planetary geometric albedo</li>
<li><strong>lamhr</strong> (<em>array</em>) – High-res wavelength grid  [um]</li>
<li><strong>solhr</strong> (<em>array</em>) – High-res TOA solar spectrum [W/m**2/um]</li>
<li><strong>lam</strong> (<em>array</em>) – Observed wavelength grid [$mu$m]</li>
<li><strong>dlam</strong> (<em>array</em>) – Observed wavelength grid widths [$mu$m]</li>
<li><strong>A</strong> (<em>array</em>) – Planetary geometric albedo at observed resolution</li>
<li><strong>Cratio</strong> (<em>array</em>) – Planet-to-star flux contrast ratio</li>
<li><strong>cp</strong> (<em>array</em>) – Planetary photon count rate [photons/s]</li>
<li><strong>csp</strong> (<em>array</em>) – Speckle count rate [photons/s]</li>
<li><strong>cz</strong> (<em>array</em>) – Zodi photon count rate [photons/s]</li>
<li><strong>cez</strong> (<em>array</em>) – Exo-zodi photon count rate [photons/s]</li>
<li><strong>cth</strong> (<em>array</em>) – Thermal photon count rate [photons/s]</li>
<li><strong>cD</strong> (<em>array</em>) – Dark current photon count rate [photons/s]</li>
<li><strong>cR</strong> (<em>array</em>) – Read noise photon count rate [photons/s]</li>
<li><strong>cc</strong> (<em>array</em>) – Clock induced charge photon count rate [photons/s]</li>
<li><strong>cb</strong> (<em>array</em>) – Total background photon noise count rate [photons/s]</li>
<li><strong>DtSNR</strong> (<em>array</em>) – Integration time to <code class="docutils literal notranslate"><span class="pre">wantsnr</span></code> [hours]</li>
<li><strong>SNRt</strong> (<em>array</em>) – S/N in a <code class="docutils literal notranslate"><span class="pre">texp</span></code> hour exposure</li>
<li><strong>Aobs</strong> (<em>array</em>) – Observed albedo with noise</li>
<li><strong>Asig</strong> (<em>array</em>) – Observed uncertainties on albedo</li>
<li><strong>Cobs</strong> (<em>array</em>) – Observed Fp/Fs with noise</li>
<li><strong>Csig</strong> (<em>array</em>) – Observed uncertainties on Fp/Fs</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coronagraph.count_rates.CoronagraphNoise.make_fake_data">
<code class="descname">make_fake_data</code><span class="sig-paren">(</span><em>texp=None</em><span class="sig-paren">)</span><a class="headerlink" href="#coronagraph.count_rates.CoronagraphNoise.make_fake_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a fake/synthetic dataset by sampling from a Gaussian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>texp</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure time [hours]. If not provided, the <code class="docutils literal notranslate"><span class="pre">CoronagraphNoise.texp</span></code>
will be used by default.</td>
</tr>
</tbody>
</table>
<p>Calling <code class="docutils literal notranslate"><span class="pre">make_fake_data()</span></code> creates the following attributes for
the <code class="docutils literal notranslate"><span class="pre">CoronagraphNoise</span></code> instance:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>SNRt</strong> (<em>array</em>) – S/N in a <code class="docutils literal notranslate"><span class="pre">texp</span></code> hour exposure</li>
<li><strong>Aobs</strong> (<em>array</em>) – Observed albedo with noise</li>
<li><strong>Asig</strong> (<em>array</em>) – Observed uncertainties on albedo</li>
<li><strong>Cobs</strong> (<em>array</em>) – Observed Fp/Fs with noise</li>
<li><strong>Csig</strong> (<em>array</em>) – Observed uncertainties on Fp/Fs</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="coronagraph.count_rates.CoronagraphNoise.plot_spectrum">
<code class="descname">plot_spectrum</code><span class="sig-paren">(</span><em>SNR_threshold=1.0</em>, <em>Nsig=6.0</em>, <em>ax0=None</em>, <em>err_kws={'alpha': 1</em>, <em>'c': 'k'</em>, <em>'fmt': '.'}</em>, <em>plot_kws={'alpha': 0.5</em>, <em>'c': 'C4'</em>, <em>'lw': 1.0}</em>, <em>draw_box=True</em><span class="sig-paren">)</span><a class="headerlink" href="#coronagraph.count_rates.CoronagraphNoise.plot_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot noised direct-imaging spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>SNR_threshold</strong> (<em>float</em>) – Threshold SNR below which do not plot</li>
<li><strong>Nsig</strong> (<em>float</em>) – Number of standard deviations about median observed points to set
yaxis limits</li>
<li><strong>ax0</strong> (<cite>matplotlib.axes</cite>) – Optional axis to provide</li>
<li><strong>err_kws</strong> (<em>dic</em>) – Keyword arguments for <cite>errorbar</cite></li>
<li><strong>plot_kws</strong> (<em>dic</em>) – Keyword arguments for <cite>plot</cite></li>
<li><strong>draw_box</strong> (<em>bool</em>) – Draw important quantities in a box?</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>fig</strong> (<cite>matplotlib.figure.Figure</cite>) – Returns a figure if <cite>ax0</cite> is <cite>None</cite></li>
<li><strong>ax</strong> (<cite>matplotlib.axes</cite>) – Returns an axis if <cite>ax0</cite> is <cite>None</cite></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only returns <cite>fig</cite> and <cite>ax</cite> is <code class="docutils literal notranslate"><span class="pre">ax0</span> <span class="pre">is</span> <span class="pre">None</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="coronagraph.count_rates.CoronagraphNoise.plot_SNR">
<code class="descname">plot_SNR</code><span class="sig-paren">(</span><em>ax0=None</em>, <em>plot_kws={'ls': 'steps-mid'}</em><span class="sig-paren">)</span><a class="headerlink" href="#coronagraph.count_rates.CoronagraphNoise.plot_SNR" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the S/N on the planet as a function of wavelength.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax0</strong> (<cite>matplotlib.axes</cite>) – Optional axis to provide</li>
<li><strong>plot_kws</strong> (<em>dic</em>) – Keyword arguments for <cite>plot</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>fig</strong> (<cite>matplotlib.figure.Figure</cite>) – Returns a figure if <cite>ax0</cite> is <cite>None</cite></li>
<li><strong>ax</strong> (<cite>matplotlib.axes</cite>) – Returns an axis if <cite>ax0</cite> is <cite>None</cite></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only returns <cite>fig</cite> and <cite>ax</cite> is <code class="docutils literal notranslate"><span class="pre">ax0</span> <span class="pre">is</span> <span class="pre">None</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="coronagraph.count_rates.CoronagraphNoise.plot_time_to_wantsnr">
<code class="descname">plot_time_to_wantsnr</code><span class="sig-paren">(</span><em>ax0=None</em>, <em>plot_kws={'alpha': 1.0</em>, <em>'ls': 'steps-mid'}</em><span class="sig-paren">)</span><a class="headerlink" href="#coronagraph.count_rates.CoronagraphNoise.plot_time_to_wantsnr" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the exposure time to get a SNR on the planet spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax0</strong> (<cite>matplotlib.axes</cite>) – Optional axis to provide</li>
<li><strong>plot_kws</strong> (<em>dic</em>) – Keyword arguments for <cite>plot</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>fig</strong> (<cite>matplotlib.figure.Figure</cite>) – Returns a figure if <cite>ax0</cite> is <cite>None</cite></li>
<li><strong>ax</strong> (<cite>matplotlib.axes</cite>) – Returns an axis if <cite>ax0</cite> is <cite>None</cite></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only returns <cite>fig</cite> and <cite>ax</cite> is <code class="docutils literal notranslate"><span class="pre">ax0</span> <span class="pre">is</span> <span class="pre">None</span></code></p>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="coronagraph.count_rates.count_rates">
<code class="descclassname">coronagraph.count_rates.</code><code class="descname">count_rates</code><span class="sig-paren">(</span><em>Ahr</em>, <em>lamhr</em>, <em>solhr</em>, <em>alpha</em>, <em>Phi</em>, <em>Rp</em>, <em>Teff</em>, <em>Rs</em>, <em>r</em>, <em>d</em>, <em>Nez</em>, <em>mode='IFS'</em>, <em>filter_wheel=None</em>, <em>lammin=0.4</em>, <em>lammax=2.5</em>, <em>Res=70.0</em>, <em>diam=10.0</em>, <em>Tput=0.2</em>, <em>C=1e-10</em>, <em>IWA=3.0</em>, <em>OWA=20.0</em>, <em>Tsys=260.0</em>, <em>Tdet=50.0</em>, <em>emis=0.9</em>, <em>De=0.0001</em>, <em>DNHpix=3.0</em>, <em>Re=0.1</em>, <em>Rc=0.0</em>, <em>Dtmax=1.0</em>, <em>X=1.5</em>, <em>qe=0.9</em>, <em>MzV=23.0</em>, <em>MezV=22.0</em>, <em>A_collect=None</em>, <em>diam_circumscribed=None</em>, <em>diam_inscribed=None</em>, <em>lam=None</em>, <em>dlam=None</em>, <em>Tput_lam=None</em>, <em>qe_lam=None</em>, <em>lammin_lenslet=None</em>, <em>wantsnr=10.0</em>, <em>FIX_OWA=False</em>, <em>COMPUTE_LAM=False</em>, <em>SILENT=False</em>, <em>NIR=False</em>, <em>THERMAL=False</em>, <em>GROUND=False</em>, <em>vod=False</em>, <em>set_fpa=None</em>, <em>CIRC=True</em>, <em>roll_maneuver=True</em><span class="sig-paren">)</span><a class="headerlink" href="#coronagraph.count_rates.count_rates" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs coronagraph model (Robinson et al., 2016) to calculate planet and noise
photon count rates for specified telescope and system parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Ahr</strong> (<em>array</em>) – High-res, wavelength-dependent planetary geometric albedo</li>
<li><strong>lamhr</strong> (<em>array</em>) – High-res wavelength grid  [um]</li>
<li><strong>solhr</strong> (<em>array</em>) – High-res TOA solar spectrum [W/m**2/um]</li>
<li><strong>alpha</strong> (<em>float</em>) – Planet phase angle [deg]</li>
<li><strong>Phi</strong> (<em>float</em>) – Planet phase function</li>
<li><strong>Rp</strong> (<em>float</em>) – Planet radius [R_earth]</li>
<li><strong>Teff</strong> (<em>float</em>) – Stellar effective temperature [K]</li>
<li><strong>Rs</strong> (<em>float</em>) – Stellar radius [R_sun]</li>
<li><strong>r</strong> (<em>float</em>) – Planet semi-major axis [AU]</li>
<li><strong>d</strong> (<em>float</em>) – Distance to observed star-planet system [pc]</li>
<li><strong>Nez</strong> (<em>float</em>) – Number of exozodis in exoplanetary disk</li>
<li><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Telescope observing mode: “IFS” or “Imaging”</li>
<li><strong>filter_wheel</strong> (<a class="reference internal" href="imager.html#coronagraph.imager.Wheel" title="coronagraph.imager.Wheel"><em>Wheel</em></a><em>, </em><em>optional</em>) – Wheel object containing imaging filters</li>
<li><strong>lammin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum wavelength [um]</li>
<li><strong>lammax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum wavelength [um]</li>
<li><strong>Res</strong> (<em>float</em><em>, </em><em>optional</em>) – Instrument spectral resolution (<code class="docutils literal notranslate"><span class="pre">lam</span> <span class="pre">/</span> <span class="pre">dlam</span></code>)</li>
<li><strong>diam</strong> (<em>float</em><em>, </em><em>optional</em>) – Telescope diameter [m]</li>
<li><strong>Tput</strong> (<em>float</em><em>, </em><em>optional</em>) – Telescope and instrument throughput</li>
<li><strong>C</strong> (<em>float</em><em>, </em><em>optional</em>) – Coronagraph design contrast</li>
<li><strong>IWA</strong> (<em>float</em><em>, </em><em>optional</em>) – Coronagraph Inner Working Angle (<code class="docutils literal notranslate"><span class="pre">lam</span> <span class="pre">/</span> <span class="pre">diam</span></code>)</li>
<li><strong>OWA</strong> (<em>float</em><em>, </em><em>optional</em>) – Coronagraph Outer Working Angle (<code class="docutils literal notranslate"><span class="pre">lam</span> <span class="pre">/</span> <span class="pre">diam</span></code>)</li>
<li><strong>Tsys</strong> (<em>float</em><em>, </em><em>optional</em>) – Telescope mirror temperature [K]</li>
<li><strong>Tdet</strong> (<em>float</em><em>, </em><em>optional</em>) – Telescope detector temperature [K]</li>
<li><strong>emis</strong> (<em>float</em><em>, </em><em>optional</em>) – Effective emissivity for the observing system (of order unity)</li>
<li><strong>De</strong> (<em>float</em><em>, </em><em>optional</em>) – Dark current [counts/s]</li>
<li><strong>DNHpix</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of horizontal/spatial pixels for dispersed spectrum</li>
<li><strong>Re</strong> (<em>float</em><em>, </em><em>optional</em>) – Read noise counts per pixel</li>
<li><strong>Rc</strong> (<em>float</em><em>, </em><em>optional</em>) – Clock induced charge [counts/pixel/photon]</li>
<li><strong>Dtmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Detector maximum exposure time [hours]</li>
<li><strong>X</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of photometric aperture (<code class="docutils literal notranslate"><span class="pre">lam</span> <span class="pre">/</span> <span class="pre">diam</span></code>)</li>
<li><strong>qe</strong> (<em>float</em><em>, </em><em>optional</em>) – Detector quantum efficiency</li>
<li><strong>MzV</strong> (<em>float</em><em>, </em><em>optional</em>) – V-band zodiacal light surface brightness [mag/arcsec**2]</li>
<li><strong>MezV</strong> (<em>float</em><em>, </em><em>optional</em>) – V-band exozodiacal light surface brightness [mag/arcsec**2]</li>
<li><strong>A_collect</strong> (<em>float</em><em>, </em><em>optional</em>) – Mirror collecting area (m**2) (uses <span class="math notranslate">\(\pi(D/2)^2\)</span> by default)</li>
<li><strong>diam_circumscribed</strong> (<em>float</em><em>, </em><em>optional</em>) – Circumscribed telescope diameter [m] used for IWA and OWA (uses <cite>diam</cite>
if <cite>None</cite> provided)</li>
<li><strong>diam_inscribed</strong> (<em>float</em><em>, </em><em>optional</em>) – Inscribed telescope diameter [m] used for lenslet calculations
(uses <cite>diam</cite> if <cite>None</cite> provided)</li>
<li><strong>lam</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Wavelength grid for spectrograph [microns] (uses <code class="docutils literal notranslate"><span class="pre">lammin</span></code>, <code class="docutils literal notranslate"><span class="pre">lammax</span></code>,
and <code class="docutils literal notranslate"><span class="pre">resolution</span></code> to determine if <code class="docutils literal notranslate"><span class="pre">None</span></code> provided)</li>
<li><strong>dlam</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Wavelength grid <cite>widths</cite> for spectrograph [microns] (uses <code class="docutils literal notranslate"><span class="pre">lammin</span></code>, <code class="docutils literal notranslate"><span class="pre">lammax</span></code>,
and <code class="docutils literal notranslate"><span class="pre">resolution</span></code> to determine if <code class="docutils literal notranslate"><span class="pre">None</span></code> provided)</li>
<li><strong>Tput_lam</strong> (<em>tuple of arrays</em>) – Wavelength-dependent throughput e.g. <code class="docutils literal notranslate"><span class="pre">(wls,</span> <span class="pre">tputs)</span></code></li>
<li><strong>qe_lam</strong> (<em>tuple of arrays</em>) – Wavelength-dependent throughput e.g. <code class="docutils literal notranslate"><span class="pre">(wls,</span> <span class="pre">qe)</span></code></li>
<li><strong>lammin_lenslet</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum wavelength to use for lenslet calculation (default is <code class="docutils literal notranslate"><span class="pre">lammin</span></code>)</li>
<li><strong>wantsnr</strong> (<em>float</em><em>, </em><em>optional</em>) – Desired signal-to-noise ratio in each pixel</li>
<li><strong>FIX_OWA</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to fix OWA at <code class="docutils literal notranslate"><span class="pre">OWA*lammin/D</span></code>, as would occur if lenslet array is
limiting the OWA</li>
<li><strong>COMPUTE_LAM</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to compute lo-res wavelength grid, otherwise the grid input as
variable <code class="docutils literal notranslate"><span class="pre">lam</span></code> is used</li>
<li><strong>SILENT</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to suppress print statements</li>
<li><strong>NIR</strong> (<em>bool</em><em>, </em><em>optional</em>) – Re-adjusts pixel size in NIR, as would occur if a second instrument
was designed to handle the NIR</li>
<li><strong>THERMAL</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to compute thermal photon counts due to telescope temperature</li>
<li><strong>GROUND</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to simulate ground-based observations through atmosphere</li>
<li><strong>vod</strong> (<em>bool</em><em>, </em><em>optional</em>) – “Valley of Death” red QE parameterization from Robinson et al. (2016)</li>
<li><strong>set_fpa</strong> (<em>float</em><em>, </em><em>optional</em>) – Specify the fraction of planetary signal in Airy pattern, default will
calculate it from the photometric aperture size <cite>X</cite></li>
<li><strong>CIRC</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to use a circular aperture</li>
<li><strong>roll_maneuver</strong> (<em>bool</em><em>, </em><em>optional</em>) – This assumes an extra factor of 2 hit to the background noise due to a
telescope roll maneuver needed to subtract out the background. See
Brown (2005) for more details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>lam</strong> (<em>ndarray</em>) – Observational wavelength grid [um]</li>
<li><strong>dlam</strong> (<em>ndarray</em>) – Observational spectral element width [um]</li>
<li><strong>A</strong> (<em>ndarray</em>) – Planetary geometric albedo on lam grid</li>
<li><strong>q</strong> (<em>ndarray</em>) – Quantum efficiency grid</li>
<li><strong>Cratio</strong> (<em>ndarray</em>) – Planet-star contrast ratio</li>
<li><strong>cp</strong> (<em>ndarray</em>) – Planetary photon count rate on detector [1/s]</li>
<li><strong>csp</strong> (<em>ndarray</em>) – Speckle photon count rate on detector [1/s]</li>
<li><strong>cz</strong> (<em>ndarray</em>) – Zodiacal photon count rate on detector [1/s]</li>
<li><strong>cez</strong> (<em>ndarray</em>) – Exozodiacal photon count rate on detector [1/s]</li>
<li><strong>cD</strong> (<em>ndarray</em>) – Dark current photon count rate on detector [1/s]</li>
<li><strong>cR</strong> (<em>ndarray</em>) – Read noise photon count rate on detector [1/s]</li>
<li><strong>cth</strong> (<em>ndarray</em>) – Instrument thermal photon count rate on detector [1/s]</li>
<li><strong>cc</strong> (<em>ndarray</em>) – Clock induced charge photon count rate [1/s]</li>
<li><strong>DtSNR</strong> (<em>ndarray</em>) – Exposure time required to get desired S/N (wantsnr) [hours]</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="observe.html" class="btn btn-neutral float-right" title="Observational Routines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../api.html" class="btn btn-neutral" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Jacob Lustig-Yaeger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>