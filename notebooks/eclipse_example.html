

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Secondary Eclipse Spectroscopy &mdash; coronagraph 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="coronagraph 1.0 documentation" href="../index.html"/>
        <link rel="up" title="Examples" href="../examples.html"/>
        <link rel="next" title="Scripts" href="../scripts.html"/>
        <link rel="prev" title="Degrading a Spectrum to Lower Resolution" href="degrading_a_spectrum.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo1.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="degrading_a_spectrum.html">Degrading a Spectrum</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Secondary Eclipse Spectroscopy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Earth-in-Emission">Earth in Emission</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulating-a-featureless-spectrum">Simulating a <em>featureless</em> spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#What-about-M-dwarfs?">What about M-dwarfs?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/jlustigy/coronagraph">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/jlustigy/coronagraph/issues">Submit an issue</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">coronagraph</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Secondary Eclipse Spectroscopy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/eclipse_example.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 0;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial was generated from a Jupyter notebook that can be
downloaded <a class="reference external" href="https://github.com/jlustigy/coronagraph/blob/master/docs/notebooks/eclipse_example.ipynb">here</a>.</p>
</div>
<div class="section" id="Secondary-Eclipse-Spectroscopy">
<h1>Secondary Eclipse Spectroscopy<a class="headerlink" href="#Secondary-Eclipse-Spectroscopy" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">coronagraph</span></code> model can be used to model exoplanet observations
using telescopes that don’t even have a coronagraph. Here we will walk
through a few examples of how to simulate secondary eclipse spectroscopy
using the generic telescope noise modeling tools available with the
<code class="docutils literal notranslate"><span class="pre">coronagraph</span></code> package.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">coronagraph</span> <span class="kn">as</span> <span class="nn">cg</span>
<span class="k">print</span><span class="p">(</span><span class="n">cg</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="section" id="Earth-in-Emission">
<h2>Earth in Emission<a class="headerlink" href="#Earth-in-Emission" title="Permalink to this headline">¶</a></h2>
<p>Let’s start out by loading a model spectrum of the Earth:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lam</span><span class="p">,</span> <span class="n">tdepth</span><span class="p">,</span> <span class="n">fplan</span><span class="p">,</span> <span class="n">fstar</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">get_earth_trans_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now we’ll define the telescope/instrument parameters for our simulation.
Let’s go big for this demo and use a 15 meter space telescope, with 50%
throughput, and a mirror temperature at absolute zero so there is no
thermal noise.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">telescope</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">Telescope</span><span class="p">(</span><span class="n">Tput</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>      <span class="c1"># Throughput</span>
                         <span class="n">D</span> <span class="o">=</span> <span class="mf">15.</span><span class="p">,</span>         <span class="c1"># Diameter [m]</span>
                         <span class="n">R</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span>          <span class="c1"># Resolving power (lam / dlam)</span>
                         <span class="n">lammin</span>  <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>   <span class="c1"># Minimum Wavelength [um]</span>
                         <span class="n">lammax</span>  <span class="o">=</span> <span class="mf">20.0</span><span class="p">,</span>  <span class="c1"># Maximum Wavelength [um]</span>
                         <span class="n">Tsys</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>      <span class="c1"># Telescope mirror temperature [K]</span>
                        <span class="p">)</span>
</pre></div>
</div>
</div>
<p>We’ll define the observed system as an Earth-Sun analog at 10 pc.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planet</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">Planet</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>   <span class="c1"># Semi-major axis [AU]</span>
                   <span class="n">d</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">,</span>  <span class="c1"># Distance [pc]</span>
                   <span class="n">Rp</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># Planet Radius [Earth Radii]</span>
                  <span class="p">)</span>

<span class="n">star</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">Star</span><span class="p">(</span><span class="n">Rs</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>      <span class="c1"># Stellar Radius [Solar Radii]</span>
               <span class="n">Teff</span> <span class="o">=</span> <span class="mf">5700.</span>   <span class="c1"># Stellar Effective Temperature [K]</span>
              <span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now let’s specify the transit/eclipse duration <code class="docutils literal notranslate"><span class="pre">tdur</span></code> for the planet
(Earth is this case), the number of eclipses to observe <code class="docutils literal notranslate"><span class="pre">ntran</span></code>, and
the amount of observing out-of-eclipse (in units of eclipse durations)
for each secondary eclipse observation <code class="docutils literal notranslate"><span class="pre">nout</span></code>. We’re going to simulate
the spectrum we would get after observing 1000 secondary eclipses of the
Earth passing behind the Sun. Obviously this is ridiculous. One thousand
secondary eclipses is not only a minimum of 8000 hours of observational
time, but it would take 1000 years to aquire such a dataset! I promise
that there is a lesson to be leared here, so let’s push forward into
infeasibility.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tdur</span> <span class="o">=</span> <span class="mf">8.0</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span>  <span class="c1"># Transit/Eclipse duration [seconds]</span>
<span class="n">ntran</span> <span class="o">=</span> <span class="mf">1e3</span>           <span class="c1"># Number of eclipses</span>
<span class="n">nout</span> <span class="o">=</span> <span class="mf">2.0</span>            <span class="c1"># Number of out-of-eclipse durations [transit durations]</span>
<span class="n">wantsnr</span> <span class="o">=</span> <span class="mf">10.0</span>        <span class="c1"># Desired S/N per resolution element (when applicable)</span>
</pre></div>
</div>
</div>
<p>Now, we’re ready to instantiate an <code class="docutils literal notranslate"><span class="pre">EclipseNoise</span></code> object for our
simulation, which contains all of the information needed to perform the
noise calculation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">en</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">EclipseNoise</span><span class="p">(</span><span class="n">tdur</span> <span class="o">=</span> <span class="n">tdur</span><span class="p">,</span>            <span class="c1"># Transit Duration</span>
                     <span class="n">telescope</span> <span class="o">=</span> <span class="n">telescope</span><span class="p">,</span>  <span class="c1"># Telescope object</span>
                     <span class="n">planet</span> <span class="o">=</span> <span class="n">planet</span><span class="p">,</span>        <span class="c1"># Planet object</span>
                     <span class="n">star</span> <span class="o">=</span> <span class="n">star</span><span class="p">,</span>            <span class="c1"># Star object</span>
                     <span class="n">ntran</span> <span class="o">=</span> <span class="n">ntran</span><span class="p">,</span>          <span class="c1"># Number of eclipses to observe</span>
                     <span class="n">nout</span> <span class="o">=</span> <span class="n">nout</span><span class="p">,</span>            <span class="c1"># Number of out-of-eclipse observing</span>
                     <span class="n">wantsnr</span> <span class="o">=</span> <span class="n">wantsnr</span><span class="p">)</span>      <span class="c1"># Desired S/N per resolution element (when applicable)</span>
</pre></div>
</div>
</div>
<p>At this point we are ready to run the simulation, so we simply call the
<code class="docutils literal notranslate"><span class="pre">run_count_rates</span></code> method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">en</span><span class="o">.</span><span class="n">run_count_rates</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">fplan</span><span class="p">,</span> <span class="n">fstar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s now plot our fiducial secondary eclipse spectrum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">SNR_threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Nsig</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;CO$_2$&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">9.6</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;O$_3$&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_18_0.png" src="../_images/notebooks_eclipse_example_18_0.png" />
</div>
</div>
<p>We can three key features. First, we note the general rising trend in
the planet-to-star flux contrast with increasing wavelength. This occurs
because, even though the Earth is much <em>much</em> more faint than the Sun at
visible wavelengths, the blackbody intensity is weakly dependent on
temperature in the Rayleigh-Jeans limit, so at these longer wavelengths
the 288 K Earth and 5700 K Sun have more similar intensities. Second, we
see absorption due to CO<span class="math notranslate">\(_2\)</span> at 15 µm. Finally, we see
absorption due to O<span class="math notranslate">\(_3\)</span> at 9.6 µm. The rise in planet-to-star
flux contrast with wavelength increases the relative size of absorption
features in the emission spectrum. At first blush this would appear to
make detecting molecules easier at longer wavelengths, however, photons
are few and far between at these wavelengths and thermal noise tends to
increase with wavelength, making the optimal wavelengths for molecular
detection more complicated and telescope-dependent.</p>
<p>Let’s take a look that the signal-to-noise as a function of wavelength.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">plot_SNRn</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_20_0.png" src="../_images/notebooks_eclipse_example_20_0.png" />
</div>
</div>
<p>Sometimes it’s nice to see the number of eclipses that must be observed
to get a given S/N in each spectral element. Let’s take a look at these
devastating numbers for the Earth around the Sun.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">plot_ntran_to_wantsnr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_22_0.png" src="../_images/notebooks_eclipse_example_22_0.png" />
</div>
</div>
<p>So this is really just too ridiculous. The ultimate reason for that can
be gleaned from the last plot in this series, where we take a look at
the photon count rates incident upon the detector from various noise
sources compared to our signal.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">plot_count_rates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_24_0.png" src="../_images/notebooks_eclipse_example_24_0.png" />
</div>
</div>
<p>We see that it’s all about the star. The themral emission from the Sun
outshines the thermal emission from the Earth by ~6 orders of magnitude
at 20 µm, and there aren’t enough photons to overcome this contrast in
any reasonable amount of time.</p>
</div>
<div class="section" id="Simulating-a-featureless-spectrum">
<h2>Simulating a <em>featureless</em> spectrum<a class="headerlink" href="#Simulating-a-featureless-spectrum" title="Permalink to this headline">¶</a></h2>
<p>We’ve heard a lot about featureless <em>transmission</em> spectra. This can
occur due to high altitude aerosols or heavy and/or cool atmospheres.
But what does a featureless emission spectrum look like?</p>
<p>In short, it looks like a ratio of blackbody fluxes:</p>
<div class="math notranslate">
\[\frac{F_p}{F_{\star}} \approx \frac{B_p}{B_{\star}} \left ( \frac{R_p}{R_{\star}} \right )^2\]</div>
<p>But let’s see how we can investigate this with the <code class="docutils literal notranslate"><span class="pre">coronagraph</span></code>
model.</p>
<p>We’re going to use the same planet and star as above, but now let’s set
a temperature for the planet:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planet</span><span class="o">.</span><span class="n">Tplan</span> <span class="o">=</span> <span class="mi">288</span>
</pre></div>
</div>
</div>
<p>Now we can create a new <code class="docutils literal notranslate"><span class="pre">EclipseNoise</span></code> object for our featureless
spectrum and calculate the photon count rates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">enf</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">EclipseNoise</span><span class="p">(</span><span class="n">tdur</span> <span class="o">=</span> <span class="n">tdur</span><span class="p">,</span>
                      <span class="n">telescope</span> <span class="o">=</span> <span class="n">telescope</span><span class="p">,</span>
                      <span class="n">planet</span> <span class="o">=</span> <span class="n">planet</span><span class="p">,</span>
                      <span class="n">star</span> <span class="o">=</span> <span class="n">star</span><span class="p">,</span>
                      <span class="n">ntran</span> <span class="o">=</span> <span class="n">ntran</span><span class="p">,</span>
                      <span class="n">nout</span> <span class="o">=</span> <span class="n">nout</span><span class="p">,</span>
                      <span class="n">wantsnr</span> <span class="o">=</span> <span class="n">wantsnr</span><span class="p">)</span>

<span class="n">enf</span><span class="o">.</span><span class="n">run_count_rates</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s plot our new featureless spectrum and compare it with Earth’s
emission spectrum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot Spectrum</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">enf</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">SNR_threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Nsig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">err_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fmt&#39;</span><span class="p">:</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                            <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Featureless&#39;</span><span class="p">})</span>

<span class="c1"># Add Earth&#39;s emission spectrum to the axis</span>
<span class="n">en</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">SNR_threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Nsig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax0</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                 <span class="n">err_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fmt&#39;</span><span class="p">:</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                 <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Earth&#39;</span><span class="p">})</span>

<span class="c1"># Add legend</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">leg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Annotate molecules</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;CO$_2$&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">9.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;O$_3$&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_31_0.png" src="../_images/notebooks_eclipse_example_31_0.png" />
</div>
</div>
</div>
<div class="section" id="What-about-M-dwarfs?">
<h2>What about M-dwarfs?<a class="headerlink" href="#What-about-M-dwarfs?" title="Permalink to this headline">¶</a></h2>
<p>So far we have looked at the extremely unrealistic scenario of observing
Earth in secondary eclipse around the Sun. Now let’s shift our focus to
the late M-dwarf TRAPPIST-1 to see what the Earth would look like in
secondary eclipse around this small, cool, dim star.</p>
<p>We’ll start by modifying the effective temperature <code class="docutils literal notranslate"><span class="pre">Teff</span></code> and the
radius <code class="docutils literal notranslate"><span class="pre">Rs</span></code> of the <code class="docutils literal notranslate"><span class="pre">star</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">star</span><span class="o">.</span><span class="n">Teff</span> <span class="o">=</span> <span class="mi">2510</span>
<span class="n">star</span><span class="o">.</span><span class="n">Rs</span> <span class="o">=</span> <span class="mf">0.117</span>
</pre></div>
</div>
</div>
<p>Let’s instantiate an <code class="docutils literal notranslate"><span class="pre">EclipseNoise</span></code> object but now we’ll use the
transit duration of TRAPPIST-1e and only observe 25 secondary eclipses.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">enm</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">EclipseNoise</span><span class="p">(</span><span class="n">tdur</span> <span class="o">=</span> <span class="mf">3432.0</span><span class="p">,</span>
                      <span class="n">telescope</span> <span class="o">=</span> <span class="n">telescope</span><span class="p">,</span>
                      <span class="n">planet</span> <span class="o">=</span> <span class="n">planet</span><span class="p">,</span>
                      <span class="n">star</span> <span class="o">=</span> <span class="n">star</span><span class="p">,</span>
                      <span class="n">ntran</span> <span class="o">=</span> <span class="mf">25.0</span><span class="p">,</span>
                      <span class="n">nout</span> <span class="o">=</span> <span class="n">nout</span><span class="p">,</span>
                      <span class="n">wantsnr</span> <span class="o">=</span> <span class="n">wantsnr</span><span class="p">)</span>

<span class="n">enm</span><span class="o">.</span><span class="n">run_count_rates</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">fplan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Here’s the emission spectrum:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">enm</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">SNR_threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Nsig</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_37_0.png" src="../_images/notebooks_eclipse_example_37_0.png" />
</div>
</div>
<p>Now we’re in business!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">enm</span><span class="o">.</span><span class="n">plot_SNRn</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_39_0.png" src="../_images/notebooks_eclipse_example_39_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">enm</span><span class="o">.</span><span class="n">recalc_wantsnr</span><span class="p">(</span><span class="n">wantsnr</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">)</span>
<span class="n">en</span><span class="o">.</span><span class="n">recalc_wantsnr</span><span class="p">(</span><span class="n">wantsnr</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">enm</span><span class="o">.</span><span class="n">plot_ntran_to_wantsnr</span><span class="p">(</span><span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span> <span class="s1">&#39;steps-mid&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span> <span class="p">:</span> <span class="s2">&quot;TRAPPIST-1&quot;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="s1">&#39;C3&#39;</span><span class="p">})</span>
<span class="n">en</span><span class="o">.</span><span class="n">plot_ntran_to_wantsnr</span><span class="p">(</span><span class="n">ax0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ls&#39;</span><span class="p">:</span> <span class="s1">&#39;steps-mid&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span> <span class="p">:</span> <span class="s2">&quot;Sun&quot;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_40_0.png" src="../_images/notebooks_eclipse_example_40_0.png" />
</div>
</div>
<p>Compared to the Sun, studying Earth temperature planets in secondary
eclipse around TRAPPIST-1 would require better than <span class="math notranslate">\(10\times\)</span>
fewer transits to reach the same S/N on the spectrum.</p>
<p>Note that a S/N of 5 on each spectral element says nothing of the
ability to detect molecules. The 15 µm CO<span class="math notranslate">\(_2\)</span> band as seen in
the spectrum above is detected at greater than S/N=5 even though the
S/N&lt;5 <em>in each element</em> within the absorption band.</p>
<p>Finally, let’s look at the photon count rates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">enm</span><span class="o">.</span><span class="n">plot_count_rates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_eclipse_example_42_0.png" src="../_images/notebooks_eclipse_example_42_0.png" />
</div>
</div>
<p>Now the contrast is <span class="math notranslate">\({\sim} 100 \times\)</span> more favorable than the
Earth-Sun system. These systems are by no means easy to study, but they
are something that we can work with!</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../scripts.html" class="btn btn-neutral float-right" title="Scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="degrading_a_spectrum.html" class="btn btn-neutral" title="Degrading a Spectrum to Lower Resolution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Jacob Lustig-Yaeger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>