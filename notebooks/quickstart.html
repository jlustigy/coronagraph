

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quickstart Tutorial &mdash; coronagraph 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="coronagraph 1.0 documentation" href="../index.html"/>
        <link rel="next" title="Examples" href="../examples.html"/>
        <link rel="prev" title="Installation" href="../install.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo1.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Model-Inputs">Model Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Running-the-coronagraph-noise-model">Running the coronagraph noise model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Analyzing-results">Analyzing results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/jlustigy/coronagraph">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/jlustigy/coronagraph/issues">Submit an issue</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">coronagraph</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Quickstart Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/quickstart.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 0;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial was generated from a Jupyter notebook that can be
downloaded <a class="reference external" href="https://github.com/jlustigy/coronagraph/blob/master/docs/notebooks/quickstart.ipynb">here</a>.</p>
</div>
<div class="section" id="Quickstart-Tutorial">
<h1>Quickstart Tutorial<a class="headerlink" href="#Quickstart-Tutorial" title="Permalink to this headline">¶</a></h1>
<p>Let’s begin by importing the coronagraph model and checking the version
number.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">coronagraph</span> <span class="kn">as</span> <span class="nn">cg</span>
<span class="k">print</span><span class="p">(</span><span class="n">cg</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="section" id="Model-Inputs">
<h2>Model Inputs<a class="headerlink" href="#Model-Inputs" title="Permalink to this headline">¶</a></h2>
<p>This model uses Python objects to hold all of the specific
telescope/coronagraph and astrophysical parameters that we want to
assume for our noise calculations. For this simple example, we’ll set up
the <code class="docutils literal notranslate"><span class="pre">Telescope</span></code>, <code class="docutils literal notranslate"><span class="pre">Planet</span></code>, and <code class="docutils literal notranslate"><span class="pre">Star</span></code> by instantiating them with
their default values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">telescope</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">Telescope</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">telescope</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Coronagraph:
------------
- Telescope observing mode : IFS
- Minimum wavelength (um) : 0.3
- Maximum wavelength (um)  : 2.0
- Spectral resolution (lambda / delta-lambda)  : 70.0
- Telescope/System temperature (K)  : 260.0
- Detector temperature (K)  : 50.0
- Telescope diameter (m)  : 8.0
- Telescope emissivity  : 0.9
- Inner Working Angle (lambda/D)  : 0.5
- Outer Working Angle (lambda/D)  : 30000.0
- Telescope throughput  : 0.2
- Raw Contrast  : 1e-10
- Dark current (s**-1)  : 0.0001
- Horizontal pixel spread of IFS spectrum  : 3.0
- Read noise per pixel  : 0.1
- Maximum exposure time (hr)  : 1.0
- Size of photometric aperture (lambda/D)  : 0.7
- Quantum efficiency  : 0.9
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planet</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">Planet</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">planet</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Planet:
-------
- Planet name  : earth
- Stellar type of planet host star : sun
- Distance to system (pc) : 10.0
- Number of exzodis (zodis) : 1.0
- Radius of planet (Earth Radii) : 1.0
- Semi-major axis (AU) : 1.0
- Phase angle (deg) : 90.0
- Lambertian phase function : 0.3183098861837907
- Zodiacal light surface brightness (mag/arcsec**2) : 23.0
- Exozodiacal light surface brightness (mag/arcsec**2) : 22.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">star</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">Star</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Star:
-----
- Effective Temperature (K) : 5780.0
- Radius (Solar Radii) : 1.0
</pre></div></div>
</div>
<p>Now let’s load in a high resolution model Earth geometric albedo
spectrum from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011AsBio..11..393R">Robinson et al.
(2011)</a>. This
iconic spectrum is provided as part of the coronagraph model, but this
step is usually project specific.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Load Earth albedo spectrum from Robinson et al. (2011)</span>
<span class="n">lamhr</span><span class="p">,</span> <span class="n">Ahr</span><span class="p">,</span> <span class="n">fstar</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">get_earth_reflect_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can take a look at the disk-integrated geomtric albedo spectrum of
the Earth with realistic cloud coverage:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create wavelength mask</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">lamhr</span> <span class="o">&gt;</span> <span class="n">telescope</span><span class="o">.</span><span class="n">lammin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lamhr</span> <span class="o">&lt;</span> <span class="n">telescope</span><span class="o">.</span><span class="n">lammax</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamhr</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">Ahr</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Wavelength [$\mu$m]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Geometric Albedo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Earth at Quadrature (Robinson et al., 2011)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_quickstart_14_0.png" src="../_images/notebooks_quickstart_14_0.png" />
</div>
</div>
</div>
<div class="section" id="Running-the-coronagraph-noise-model">
<h2>Running the coronagraph noise model<a class="headerlink" href="#Running-the-coronagraph-noise-model" title="Permalink to this headline">¶</a></h2>
<p>Now we want to calculate the photon count rates incident upon the
detector due to the planet and noise sources. We can accomplish all of
this with a <code class="docutils literal notranslate"><span class="pre">CoronagraphNoise</span></code> object, to which we pass our existing
<code class="docutils literal notranslate"><span class="pre">telescope</span></code>, <code class="docutils literal notranslate"><span class="pre">planet</span></code>, and <code class="docutils literal notranslate"><span class="pre">star</span></code> configurations. In addition, we
will set the nominal exposure time in hours, <code class="docutils literal notranslate"><span class="pre">texp</span></code>, and/or a desired
signal-to-noise ratio to obtain in each spectral element, <code class="docutils literal notranslate"><span class="pre">wantsnr</span></code>.
Note <code class="docutils literal notranslate"><span class="pre">texp</span></code> and <code class="docutils literal notranslate"><span class="pre">wantsnr</span></code> cannot both be satisfied simultaneously,
and they can be changed at a later time without needing to recompute the
photon count rates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define CoronagraphNoise object using our telescope, planet, and star</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">CoronagraphNoise</span><span class="p">(</span><span class="n">telescope</span> <span class="o">=</span> <span class="n">telescope</span><span class="p">,</span>
                            <span class="n">planet</span> <span class="o">=</span> <span class="n">planet</span><span class="p">,</span>
                            <span class="n">star</span> <span class="o">=</span> <span class="n">star</span><span class="p">,</span>
                            <span class="n">texp</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">,</span>
                            <span class="n">wantsnr</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>At this point we are ready to run the code to compute the desired photon
count rates for our specific planetary spectrum. To do this simply call
<code class="docutils literal notranslate"><span class="pre">run_count_rates</span></code> and provide the high-res planet spectrum, stellar
spectrum, and wavelength grid.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate the planet and noise photon count rates</span>
<span class="n">noise</span><span class="o">.</span><span class="n">run_count_rates</span><span class="p">(</span><span class="n">Ahr</span><span class="p">,</span> <span class="n">lamhr</span><span class="p">,</span> <span class="n">fstar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Analyzing-results">
<h2>Analyzing results<a class="headerlink" href="#Analyzing-results" title="Permalink to this headline">¶</a></h2>
<p>After <code class="docutils literal notranslate"><span class="pre">run_count_rates</span></code> has been run, we can access the individual
wavelength-dependent noise terms as attributes of the <code class="docutils literal notranslate"><span class="pre">noise</span></code> instance
of the <code class="docutils literal notranslate"><span class="pre">CoronagraphNoise</span></code> object. For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [$\mu$m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Photon Count Rate [1/s]&quot;</span><span class="p">)</span>

<span class="c1"># Plot the different photon count rates</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cp</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;planet&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">csp</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;speckles&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cD</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;dark current&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cR</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;read&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cth</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;thermal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cz</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;zodi&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cez</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;exo-zodi&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cc</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;clock induced charge&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">cb</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;total background&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="c1"># Tweak aesthetics</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mf">1e1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">framealpha</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_quickstart_22_0.png" src="../_images/notebooks_quickstart_22_0.png" />
</div>
</div>
<p>We can also plot the spectrum with randomly drawn Gaussian noise for our
nominal exposure time:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [$\mu$m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Geometric Albedo&quot;</span><span class="p">)</span>

<span class="c1"># Plot the different photon count rates</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamhr</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">Ahr</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;high-res model&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;binned model&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;steps-mid&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">Aobs</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">noise</span><span class="o">.</span><span class="n">Asig</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;mock observations&quot;</span><span class="p">)</span>

<span class="c1"># Tweak aesthetics</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">framealpha</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_quickstart_24_0.png" src="../_images/notebooks_quickstart_24_0.png" />
</div>
</div>
<p>A version of the above plot can be made using <code class="docutils literal notranslate"><span class="pre">noise.plot_spectrum()</span></code>,
but it is not used here for model clarity in this tutorial.</p>
<p>The above plot gives us a quick look at the data quality that we might
expect for an observation using the telescope and system setup. These
data can be saved and used in retrieval tests to see if the true
underlying atmospheric structure of the Earth can be extracted.</p>
<p>It’s also useful to look at the signal-to-noise (S/N) ratio in each
spectral element to see what wavelengths we are getting the highest S/N.
We can access the wavelength dependent S/N for our selected exposure
time via <code class="docutils literal notranslate"><span class="pre">noise.SNRt</span></code>. For example,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [$\mu$m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;S/N in </span><span class="si">%.1f</span><span class="s2"> hours&quot;</span> <span class="o">%</span><span class="k">noise</span>.wantsnr)

<span class="c1"># Plot the different photon count rates</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">SNRt</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;steps-mid&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_quickstart_26_0.png" src="../_images/notebooks_quickstart_26_0.png" />
</div>
</div>
<p>A version of the above plot can be made using <code class="docutils literal notranslate"><span class="pre">noise.plot_SNR()</span></code>.</p>
<p>We can see that the S/N has the same general shape as the stellar SED.
We are, after all, observing stellar light reflected off a planet. As a
result, the S/N is the highest where the Sun outputs the most photons:
around 500 nm. But the S/N is not just the stellar SED, it is the
stellar SED <em>convolved with the planet’s reflectivity</em>. So we get lower
S/N in the bottom of molecular absorption bands and higher S/N in the
continuum between the bands. The peak in S/N near 0.75 µm is due to the
increase in albedo of the Earth’s surface (particularly land and
vegetation) at that wavelength compared to shorter wavelengths where the
Sun emits more photons.</p>
<p>Finally, let’s take a look at the exposure time necessary to achieve a
given signal-to-noise ratio (<code class="docutils literal notranslate"><span class="pre">wantsnr</span></code>). This calculated quantity can
be accessed via <code class="docutils literal notranslate"><span class="pre">noise.DtSNR</span></code>. For example,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [$\mu$m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Hours to S/N = </span><span class="si">%.1f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">noise</span>.texp)

<span class="c1"># Plot the different photon count rates</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">DtSNR</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;steps-mid&quot;</span><span class="p">)</span>

<span class="c1"># Tweak aesthetics</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_quickstart_28_0.png" src="../_images/notebooks_quickstart_28_0.png" />
</div>
</div>
<p>A version of the above plot can be made using
<code class="docutils literal notranslate"><span class="pre">noise.plot_time_to_wantsnr()</span></code>.</p>
<p>The exposure time in each spectral element is inversely proportional to
the S/N squared, <span class="math notranslate">\(t_{\text{exp}} \propto (\text{S/N})^{-2}\)</span>, so
this plot is inverted compared to the last one. Here we see that
ridiculously infeasible exposure times are required to achieve high S/N
at the wavelengths where fewer photons are reflected off the planet. Of
course, this is all assuming that the exoplanet we are looking at <em>is</em>
Earth. This is an extremely useful benchmark calculation to make (let’s
make sure we build a telescope capable of studying an exact exo-Earth),
but as we see in this example, the spectrum, exposure time, and S/N are
all quite dependent on the nature of the exoplanet, which we won’t know
<em>a priori</em>. So now you can use this model with your own simulated
exoplanet spectra to see what a future telescope can do for you!</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../install.html" class="btn btn-neutral" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Jacob Lustig-Yaeger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>